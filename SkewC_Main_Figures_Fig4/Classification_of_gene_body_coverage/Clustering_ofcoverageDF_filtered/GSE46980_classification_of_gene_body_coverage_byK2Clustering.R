### 20190606
## Filter low cells with low number of input reads 
library(ggplot2)
#### 
png(filename = "./Classification_of_gene_body_coverage/Clustering_ofcoverageDF_filtered/GSE46980_Skewed_cells.png",height = 400,width = 400,res = 70)
x = 1:100
color=rgb(0,0,0,alpha=0.25) 
par(mai=c(0.82,0.82,0.62,0.12))
plot(
  x,
  SRR1043197,col.axis="black",font.axis=2,
  type = 'l',col= color,
  main = list("mES | GSE46980-R1 live cells\nSkewed gene coverage (n=48:87)",cex=1.5,col = "black",font=2),
  ylab = list("Gene coverage", col = "black",cex=1.5,font=2),
  xlab = list("Gene body percentile (5'-> 3')", col = "black",cex=1.5,font=2),
  col.main = "blue",cex.lab=3,font.lab=2)
lines(x,SRR1043203,type='l',col= color)
lines(x,SRR1043205,type='l',col= color)
lines(x,SRR1043209,type='l',col= color)
lines(x,SRR1043211,type='l',col= color)
lines(x,SRR1043213,type='l',col= color)
lines(x,SRR1043215,type='l',col= color)
lines(x,SRR1043221,type='l',col= color)
lines(x,SRR1043223,type='l',col= color)
lines(x,SRR1043225,type='l',col= color)
lines(x,SRR1043227,type='l',col= color)
lines(x,SRR1043231,type='l',col= color)
lines(x,SRR1043235,type='l',col= color)
lines(x,SRR1043237,type='l',col= color)
lines(x,SRR1043239,type='l',col= color)
lines(x,SRR1043241,type='l',col= color)
lines(x,SRR1043243,type='l',col= color)
lines(x,SRR1043249,type='l',col= color)
lines(x,SRR1043251,type='l',col= color)
lines(x,SRR1043255,type='l',col= color)
lines(x,SRR1043263,type='l',col= color)
lines(x,SRR1043265,type='l',col= color)
lines(x,SRR1043269,type='l',col= color)
lines(x,SRR1043281,type='l',col= color)
lines(x,SRR1043285,type='l',col= color)
lines(x,SRR1043287,type='l',col= color)
lines(x,SRR1043289,type='l',col= color)
lines(x,SRR1043297,type='l',col= color)
lines(x,SRR1043303,type='l',col= color)
lines(x,SRR1043305,type='l',col= color)
lines(x,SRR1043309,type='l',col= color)
lines(x,SRR1043311,type='l',col= color)
lines(x,SRR1043317,type='l',col= color)
lines(x,SRR1043319,type='l',col= color)
lines(x,SRR1043321,type='l',col= color)
lines(x,SRR1043323,type='l',col= color)
lines(x,SRR1043325,type='l',col= color)
lines(x,SRR1043335,type='l',col= color)
lines(x,SRR1043339,type='l',col= color)
lines(x,SRR1043347,type='l',col= color)
lines(x,SRR1043359,type='l',col= color)
lines(x,SRR1043365,type='l',col= color)
lines(x,SRR1043367,type='l',col= color)
lines(x,SRR1043369,type='l',col= color)
lines(x,SRR1043371,type='l',col= color)
lines(x,SRR1043373,type='l',col= color)
lines(x,SRR1043385,type='l',col= color)
lines(x,SRR1043387,type='l',col= color)

box(lty = "solid", col = 'black',lwd=3)
axis(side=1,lwd=2,lwd.ticks=4,col.ticks="black")
axis(side=2,lwd=3,lwd.ticks=4,col.ticks="black")
dev.off()

##### ##### ### GOOD cells cluster #1
png(filename = "./Classification_of_gene_body_coverage/Clustering_ofcoverageDF_filtered/GSE46980_GoodCells.png",height = 400,width = 400,res = 70)
x = 1:100
color=rgb(0,0,0,alpha=0.25) 
par(mai=c(0.82,0.82,0.62,0.12))
plot(
  x,
  SRR1043199,col.axis="black",font.axis=2,
  type = 'l',col= color,
  main = list("mES | GSE46980-R1 live cells |\nGood cells (n=39:87)",cex=1.5,col = "black",font=2),
  ylab = list("Gene coverage", col = "black",cex=1.5,font=2),
  xlab = list("Gene body percentile (5'-> 3')", col = "black",cex=1.5,font=2),
  col.main = "blue",cex.lab=3,font.lab=2)
lines(x,SRR1043201,type='l',col= color)
lines(x,SRR1043217,type='l',col= color)
lines(x,SRR1043219,type='l',col= color)
lines(x,SRR1043229,type='l',col= color)
lines(x,SRR1043245,type='l',col= color)
lines(x,SRR1043257,type='l',col= color)
lines(x,SRR1043259,type='l',col= color)
lines(x,SRR1043261,type='l',col= color)
lines(x,SRR1043267,type='l',col= color)
lines(x,SRR1043273,type='l',col= color)
lines(x,SRR1043275,type='l',col= color)
lines(x,SRR1043277,type='l',col= color)
lines(x,SRR1043279,type='l',col= color)
lines(x,SRR1043283,type='l',col= color)
lines(x,SRR1043291,type='l',col= color)
lines(x,SRR1043293,type='l',col= color)
lines(x,SRR1043295,type='l',col= color)
lines(x,SRR1043299,type='l',col= color)
lines(x,SRR1043301,type='l',col= color)
lines(x,SRR1043307,type='l',col= color)
lines(x,SRR1043313,type='l',col= color)
lines(x,SRR1043315,type='l',col= color)
lines(x,SRR1043327,type='l',col= color)
lines(x,SRR1043329,type='l',col= color)
lines(x,SRR1043333,type='l',col= color)
lines(x,SRR1043337,type='l',col= color)
lines(x,SRR1043341,type='l',col= color)
lines(x,SRR1043343,type='l',col= color)
lines(x,SRR1043345,type='l',col= color)
lines(x,SRR1043351,type='l',col= color)
lines(x,SRR1043353,type='l',col= color)
lines(x,SRR1043355,type='l',col= color)
lines(x,SRR1043361,type='l',col= color)
lines(x,SRR1043363,type='l',col= color)
lines(x,SRR1043375,type='l',col= color)
lines(x,SRR1043377,type='l',col= color)
lines(x,SRR1043381,type='l',col= color)
lines(x,SRR1043383,type='l',col= color)
box(lty = "solid", col = 'black',lwd=3)
axis(side=1,lwd=2,lwd.ticks=4,col.ticks="black")
axis(side=2,lwd=3,lwd.ticks=4,col.ticks="black")
dev.off()